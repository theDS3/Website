---
import '@fontsource-variable/josefin-sans';

import Particles from 'astro-particles';
import type { ISourceOptions } from 'tsparticles-engine';

import Footer from './Footer.astro';
import Header from './Header.astro';

import particleJSOptions from '../config/particlesjs.json';
import '../styles/main.scss';

interface Props {
  title?: string;
  includeHeader?: boolean;
}

const { title = 'DS3', includeHeader = true } = Astro.props;
---

<html lang="en">
  <head>
    <link rel="sitemap" href="../../dist/sitemap-index.xml" />
    <meta charset="utf-8" />
    <link
      rel="icon"
      type="image/svg+xml"
      href="/favicon.svg"
    />
    <meta
      name="viewport"
      content="width=device-width"
    />
    <meta
      name="generator"
      content={Astro.generator}
    />
    <title>{title}</title>
  </head>
  <body>
    {includeHeader && <Header />}
    <main>
      <slot />
    </main>
    <Footer />
    <Particles
      id="tsparticles"
      options={particleJSOptions as ISourceOptions}
      init="particlesInit"
    />
  </body>

  <script
    src="https://code.iconify.design/iconify-icon/1.0.7/iconify-icon.min.js"
  ></script>

  <script>
    import type { Engine } from 'tsparticles-engine';
    import { loadFull } from 'tsparticles';

    declare global {
      interface Window {
        particlesInit: (engine: Engine) => Promise<void>;
      }
    }

    // the function name is the parameter passed to the init attribute
    // required
    // add the function to window is mandatory, it will be searched there
    window.particlesInit = async function (engine: Engine) {
      await loadFull(engine);
    };
  </script>
</html>
